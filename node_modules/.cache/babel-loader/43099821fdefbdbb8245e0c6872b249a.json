{"ast":null,"code":"\"use strict\";\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nvar _a;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.AppNear = void 0;\nconst types_1 = require(\"../../../../../common/types\");\nconst bs58_1 = __importDefault(require(\"bs58\"));\nconst isomorphic_ws_1 = __importDefault(require(\"isomorphic-ws\"));\nconst near_api_js_1 = require(\"near-api-js\");\nconst utils_1 = require(\"near-api-js/lib/utils\");\nconst AppMessages_1 = require(\"../types/AppMessages\");\nconst ServerMessage_1 = require(\"../types/ServerMessage\");\nconst utils_2 = require(\"../utils\");\nconst isomorphic_localstorage_1 = __importDefault(require(\"isomorphic-localstorage\"));\nconst localStorage = (0, isomorphic_localstorage_1.default)('./.localstorage');\nconst sessionIdKey = 'nightly-id-near';\nclass AppNear {\n  constructor(ws, timeout) {\n    this.events = {};\n    this.sessionId = '';\n    this.send = message => __awaiter(this, void 0, void 0, function* () {\n      return new Promise((resolve, reject) => {\n        const id = (0, utils_2.getRandomId)();\n        const request = JSON.stringify(Object.assign(Object.assign({}, message), {\n          id: id\n        }));\n        // Set up the timeout\n        const timer = setTimeout(() => {\n          reject(new Error(`Connection timed out after ${this.timeout} ms`));\n        }, this.timeout);\n        this.events[id] = response => {\n          clearTimeout(timer);\n          if (response.type === ServerMessage_1.ServerMessageTypes.Error) {\n            reject(response.msg);\n          } else {\n            resolve(response);\n          }\n        };\n        this.ws.send(request);\n      });\n    });\n    this.signTransaction = transaction => __awaiter(this, void 0, void 0, function* () {\n      const request = {\n        transaction: Buffer.from(transaction.encode()).toString('hex'),\n        network: types_1.NETWORK.NEAR,\n        type: AppMessages_1.AppMessageTypes.SignTransaction\n      };\n      const response = yield this.send(request);\n      return near_api_js_1.transactions.SignedTransaction.decode(Buffer.from(response.transaction, 'hex'));\n    });\n    this.signAllTransactions = txs => __awaiter(this, void 0, void 0, function* () {\n      const request = {\n        transactions: txs.map(tx => Buffer.from(tx.encode()).toString('hex')),\n        network: types_1.NETWORK.NEAR,\n        type: AppMessages_1.AppMessageTypes.SignAllTransactions\n      };\n      const response = yield this.send(request);\n      const parsed = response.transactions.map(tx => near_api_js_1.transactions.SignedTransaction.decode(Buffer.from(tx, 'hex')));\n      return parsed;\n    });\n    this.signMessage = message => __awaiter(this, void 0, void 0, function* () {\n      const request = {\n        message,\n        network: types_1.NETWORK.NEAR,\n        type: AppMessages_1.AppMessageTypes.SignMessage\n      };\n      const response = yield this.send(request);\n      return Uint8Array.from(Buffer.from(response.signature, 'hex'));\n    });\n    this.ws = ws;\n    this.timeout = timeout;\n  }\n}\nexports.AppNear = AppNear;\n_a = AppNear;\nAppNear.build = _ref => {\n  let {\n    appMetadata,\n    url,\n    onUserConnect,\n    timeout = 40 * 1000 // 40s default timeout\n  } = _ref;\n  return __awaiter(void 0, void 0, void 0, function* () {\n    return new Promise((resolve, reject) => {\n      const persistent = typeof appMetadata.persistent === 'undefined' ? true : appMetadata.persistent;\n      const ws = url ? new isomorphic_ws_1.default(url) : new isomorphic_ws_1.default('wss://relay.nightly.app/app');\n      const connection = new AppNear(ws, timeout);\n      connection.events[ServerMessage_1.ServerMessageTypes.UserConnected] = data => {\n        const parsedMeta = JSON.parse(data.metadata);\n        const pk = utils_1.PublicKey.fromString(bs58_1.default.encode(Buffer.from(data.publicKey, 'hex')));\n        onUserConnect({\n          accountId: parsedMeta.accountId,\n          publicKey: pk\n        });\n      };\n      connection.ws.onopen = () => {\n        var _b;\n        connection.ws.onmessage = _ref2 => {\n          let {\n            data\n          } = _ref2;\n          const response = JSON.parse(data);\n          connection.events[response.id](response);\n        };\n        const persistentSessionId = persistent ? (_b = localStorage.getItem(sessionIdKey)) !== null && _b !== void 0 ? _b : undefined : undefined;\n        const request = (0, AppMessages_1.createInitAction)(Object.assign(Object.assign({}, appMetadata), {\n          network: types_1.NETWORK.NEAR,\n          persistentSessionId\n        }));\n        // Set up the timeout\n        const timer = setTimeout(() => {\n          reject(new Error(`Connection timed out after ${connection.timeout} ms`));\n        }, timeout);\n        connection.events[request.id] = response => {\n          clearTimeout(timer);\n          if (response.type === ServerMessage_1.ServerMessageTypes.InitSuccess) {\n            connection.sessionId = response.sessionId;\n            if (persistent) localStorage.setItem(sessionIdKey, response.sessionId);\n            resolve(connection);\n          } else {\n            reject();\n          }\n        };\n        connection.ws.send(JSON.stringify(request));\n      };\n    });\n  });\n};","map":{"version":3,"names":["__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","__importDefault","mod","__esModule","_a","Object","defineProperty","exports","AppNear","types_1","require","bs58_1","isomorphic_ws_1","near_api_js_1","utils_1","AppMessages_1","ServerMessage_1","utils_2","isomorphic_localstorage_1","localStorage","default","sessionIdKey","constructor","ws","timeout","events","sessionId","send","message","id","getRandomId","request","JSON","stringify","assign","timer","setTimeout","Error","response","clearTimeout","type","ServerMessageTypes","msg","signTransaction","transaction","Buffer","from","encode","toString","network","NETWORK","NEAR","AppMessageTypes","SignTransaction","transactions","SignedTransaction","decode","signAllTransactions","txs","map","tx","SignAllTransactions","parsed","signMessage","SignMessage","Uint8Array","signature","build","appMetadata","url","onUserConnect","persistent","connection","UserConnected","data","parsedMeta","parse","metadata","pk","PublicKey","fromString","publicKey","accountId","onopen","_b","onmessage","persistentSessionId","getItem","undefined","createInitAction","InitSuccess","setItem"],"sources":["/Users/sepezho/Work/tonana/fe/node_modules/@nightlylabs/connect-near/lib/nightlyConnect/connect/sdk/src/near/appNear.js"],"sourcesContent":["\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nvar _a;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.AppNear = void 0;\nconst types_1 = require(\"../../../../../common/types\");\nconst bs58_1 = __importDefault(require(\"bs58\"));\nconst isomorphic_ws_1 = __importDefault(require(\"isomorphic-ws\"));\nconst near_api_js_1 = require(\"near-api-js\");\nconst utils_1 = require(\"near-api-js/lib/utils\");\nconst AppMessages_1 = require(\"../types/AppMessages\");\nconst ServerMessage_1 = require(\"../types/ServerMessage\");\nconst utils_2 = require(\"../utils\");\nconst isomorphic_localstorage_1 = __importDefault(require(\"isomorphic-localstorage\"));\nconst localStorage = (0, isomorphic_localstorage_1.default)('./.localstorage');\nconst sessionIdKey = 'nightly-id-near';\nclass AppNear {\n    constructor(ws, timeout) {\n        this.events = {};\n        this.sessionId = '';\n        this.send = (message) => __awaiter(this, void 0, void 0, function* () {\n            return new Promise((resolve, reject) => {\n                const id = (0, utils_2.getRandomId)();\n                const request = JSON.stringify(Object.assign(Object.assign({}, message), { id: id }));\n                // Set up the timeout\n                const timer = setTimeout(() => {\n                    reject(new Error(`Connection timed out after ${this.timeout} ms`));\n                }, this.timeout);\n                this.events[id] = (response) => {\n                    clearTimeout(timer);\n                    if (response.type === ServerMessage_1.ServerMessageTypes.Error) {\n                        reject(response.msg);\n                    }\n                    else {\n                        resolve(response);\n                    }\n                };\n                this.ws.send(request);\n            });\n        });\n        this.signTransaction = (transaction) => __awaiter(this, void 0, void 0, function* () {\n            const request = {\n                transaction: Buffer.from(transaction.encode()).toString('hex'),\n                network: types_1.NETWORK.NEAR,\n                type: AppMessages_1.AppMessageTypes.SignTransaction\n            };\n            const response = (yield this.send(request));\n            return near_api_js_1.transactions.SignedTransaction.decode(Buffer.from(response.transaction, 'hex'));\n        });\n        this.signAllTransactions = (txs) => __awaiter(this, void 0, void 0, function* () {\n            const request = {\n                transactions: txs.map((tx) => Buffer.from(tx.encode()).toString('hex')),\n                network: types_1.NETWORK.NEAR,\n                type: AppMessages_1.AppMessageTypes.SignAllTransactions\n            };\n            const response = (yield this.send(request));\n            const parsed = response.transactions.map((tx) => near_api_js_1.transactions.SignedTransaction.decode(Buffer.from(tx, 'hex')));\n            return parsed;\n        });\n        this.signMessage = (message) => __awaiter(this, void 0, void 0, function* () {\n            const request = {\n                message,\n                network: types_1.NETWORK.NEAR,\n                type: AppMessages_1.AppMessageTypes.SignMessage\n            };\n            const response = (yield this.send(request));\n            return Uint8Array.from(Buffer.from(response.signature, 'hex'));\n        });\n        this.ws = ws;\n        this.timeout = timeout;\n    }\n}\nexports.AppNear = AppNear;\n_a = AppNear;\nAppNear.build = ({ appMetadata, url, onUserConnect, timeout = 40 * 1000 // 40s default timeout\n }) => __awaiter(void 0, void 0, void 0, function* () {\n    return new Promise((resolve, reject) => {\n        const persistent = typeof appMetadata.persistent === 'undefined' ? true : appMetadata.persistent;\n        const ws = url ? new isomorphic_ws_1.default(url) : new isomorphic_ws_1.default('wss://relay.nightly.app/app');\n        const connection = new AppNear(ws, timeout);\n        connection.events[ServerMessage_1.ServerMessageTypes.UserConnected] = (data) => {\n            const parsedMeta = JSON.parse(data.metadata);\n            const pk = utils_1.PublicKey.fromString(bs58_1.default.encode(Buffer.from(data.publicKey, 'hex')));\n            onUserConnect({ accountId: parsedMeta.accountId, publicKey: pk });\n        };\n        connection.ws.onopen = () => {\n            var _b;\n            connection.ws.onmessage = ({ data }) => {\n                const response = JSON.parse(data);\n                connection.events[response.id](response);\n            };\n            const persistentSessionId = persistent\n                ? (_b = localStorage.getItem(sessionIdKey)) !== null && _b !== void 0 ? _b : undefined\n                : undefined;\n            const request = (0, AppMessages_1.createInitAction)(Object.assign(Object.assign({}, appMetadata), { network: types_1.NETWORK.NEAR, persistentSessionId }));\n            // Set up the timeout\n            const timer = setTimeout(() => {\n                reject(new Error(`Connection timed out after ${connection.timeout} ms`));\n            }, timeout);\n            connection.events[request.id] = (response) => {\n                clearTimeout(timer);\n                if (response.type === ServerMessage_1.ServerMessageTypes.InitSuccess) {\n                    connection.sessionId = response.sessionId;\n                    if (persistent)\n                        localStorage.setItem(sessionIdKey, response.sessionId);\n                    resolve(connection);\n                }\n                else {\n                    reject();\n                }\n            };\n            connection.ws.send(JSON.stringify(request));\n        };\n    });\n});\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}