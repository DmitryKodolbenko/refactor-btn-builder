{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.BrowserLocalStorageKeyStore = void 0;\nconst keystore_1 = require(\"./keystore\");\nconst key_pair_1 = require(\"../utils/key_pair\");\nconst LOCAL_STORAGE_KEY_PREFIX = 'near-api-js:keystore:';\n/**\n * This class is used to store keys in the browsers local storage.\n *\n * @example {@link https://docs.near.org/docs/develop/front-end/naj-quick-reference#key-store}\n * @example\n * ```js\n * import { connect, keyStores } from 'near-api-js';\n *\n * const keyStore = new keyStores.BrowserLocalStorageKeyStore();\n * const config = {\n *   keyStore, // instance of BrowserLocalStorageKeyStore\n *   networkId: 'testnet',\n *   nodeUrl: 'https://rpc.testnet.near.org',\n *   walletUrl: 'https://wallet.testnet.near.org',\n *   helperUrl: 'https://helper.testnet.near.org',\n *   explorerUrl: 'https://explorer.testnet.near.org'\n * };\n *\n * // inside an async function\n * const near = await connect(config)\n * ```\n */\nclass BrowserLocalStorageKeyStore extends keystore_1.KeyStore {\n  /**\n   * @param localStorage defaults to window.localStorage\n   * @param prefix defaults to `near-api-js:keystore:`\n   */\n  constructor() {\n    let localStorage = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : window.localStorage;\n    let prefix = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : LOCAL_STORAGE_KEY_PREFIX;\n    super();\n    this.localStorage = localStorage;\n    this.prefix = prefix;\n  }\n  /**\n   * Stores a {@link KeyPair} in local storage.\n   * @param networkId The targeted network. (ex. default, betanet, etc…)\n   * @param accountId The NEAR account tied to the key pair\n   * @param keyPair The key pair to store in local storage\n   */\n  async setKey(networkId, accountId, keyPair) {\n    this.localStorage.setItem(this.storageKeyForSecretKey(networkId, accountId), keyPair.toString());\n  }\n  /**\n   * Gets a {@link KeyPair} from local storage\n   * @param networkId The targeted network. (ex. default, betanet, etc…)\n   * @param accountId The NEAR account tied to the key pair\n   * @returns {Promise<KeyPair>}\n   */\n  async getKey(networkId, accountId) {\n    const value = this.localStorage.getItem(this.storageKeyForSecretKey(networkId, accountId));\n    if (!value) {\n      return null;\n    }\n    return key_pair_1.KeyPair.fromString(value);\n  }\n  /**\n   * Removes a {@link KeyPair} from local storage\n   * @param networkId The targeted network. (ex. default, betanet, etc…)\n   * @param accountId The NEAR account tied to the key pair\n   */\n  async removeKey(networkId, accountId) {\n    this.localStorage.removeItem(this.storageKeyForSecretKey(networkId, accountId));\n  }\n  /**\n   * Removes all items that start with `prefix` from local storage\n   */\n  async clear() {\n    for (const key of this.storageKeys()) {\n      if (key.startsWith(this.prefix)) {\n        this.localStorage.removeItem(key);\n      }\n    }\n  }\n  /**\n   * Get the network(s) from local storage\n   * @returns {Promise<string[]>}\n   */\n  async getNetworks() {\n    const result = new Set();\n    for (const key of this.storageKeys()) {\n      if (key.startsWith(this.prefix)) {\n        const parts = key.substring(this.prefix.length).split(':');\n        result.add(parts[1]);\n      }\n    }\n    return Array.from(result.values());\n  }\n  /**\n   * Gets the account(s) from local storage\n   * @param networkId The targeted network. (ex. default, betanet, etc…)\n   * @returns{Promise<string[]>}\n   */\n  async getAccounts(networkId) {\n    const result = new Array();\n    for (const key of this.storageKeys()) {\n      if (key.startsWith(this.prefix)) {\n        const parts = key.substring(this.prefix.length).split(':');\n        if (parts[1] === networkId) {\n          result.push(parts[0]);\n        }\n      }\n    }\n    return result;\n  }\n  /**\n   * @hidden\n   * Helper function to retrieve a local storage key\n   * @param networkId The targeted network. (ex. default, betanet, etc…)\n   * @param accountId The NEAR account tied to the storage keythat's sought\n   * @returns {string} An example might be: `near-api-js:keystore:near-friend:default`\n   */\n  storageKeyForSecretKey(networkId, accountId) {\n    return `${this.prefix}${accountId}:${networkId}`;\n  }\n  /** @hidden */\n  *storageKeys() {\n    for (let i = 0; i < this.localStorage.length; i++) {\n      yield this.localStorage.key(i);\n    }\n  }\n}\nexports.BrowserLocalStorageKeyStore = BrowserLocalStorageKeyStore;","map":{"version":3,"names":["Object","defineProperty","exports","value","BrowserLocalStorageKeyStore","keystore_1","require","key_pair_1","LOCAL_STORAGE_KEY_PREFIX","KeyStore","constructor","localStorage","window","prefix","setKey","networkId","accountId","keyPair","setItem","storageKeyForSecretKey","toString","getKey","getItem","KeyPair","fromString","removeKey","removeItem","clear","key","storageKeys","startsWith","getNetworks","result","Set","parts","substring","length","split","add","Array","from","values","getAccounts","push","i"],"sources":["/Users/sepezho/Work/tonana/fe/node_modules/near-api-js/lib/key_stores/browser_local_storage_key_store.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.BrowserLocalStorageKeyStore = void 0;\nconst keystore_1 = require(\"./keystore\");\nconst key_pair_1 = require(\"../utils/key_pair\");\nconst LOCAL_STORAGE_KEY_PREFIX = 'near-api-js:keystore:';\n/**\n * This class is used to store keys in the browsers local storage.\n *\n * @example {@link https://docs.near.org/docs/develop/front-end/naj-quick-reference#key-store}\n * @example\n * ```js\n * import { connect, keyStores } from 'near-api-js';\n *\n * const keyStore = new keyStores.BrowserLocalStorageKeyStore();\n * const config = {\n *   keyStore, // instance of BrowserLocalStorageKeyStore\n *   networkId: 'testnet',\n *   nodeUrl: 'https://rpc.testnet.near.org',\n *   walletUrl: 'https://wallet.testnet.near.org',\n *   helperUrl: 'https://helper.testnet.near.org',\n *   explorerUrl: 'https://explorer.testnet.near.org'\n * };\n *\n * // inside an async function\n * const near = await connect(config)\n * ```\n */\nclass BrowserLocalStorageKeyStore extends keystore_1.KeyStore {\n    /**\n     * @param localStorage defaults to window.localStorage\n     * @param prefix defaults to `near-api-js:keystore:`\n     */\n    constructor(localStorage = window.localStorage, prefix = LOCAL_STORAGE_KEY_PREFIX) {\n        super();\n        this.localStorage = localStorage;\n        this.prefix = prefix;\n    }\n    /**\n     * Stores a {@link KeyPair} in local storage.\n     * @param networkId The targeted network. (ex. default, betanet, etc…)\n     * @param accountId The NEAR account tied to the key pair\n     * @param keyPair The key pair to store in local storage\n     */\n    async setKey(networkId, accountId, keyPair) {\n        this.localStorage.setItem(this.storageKeyForSecretKey(networkId, accountId), keyPair.toString());\n    }\n    /**\n     * Gets a {@link KeyPair} from local storage\n     * @param networkId The targeted network. (ex. default, betanet, etc…)\n     * @param accountId The NEAR account tied to the key pair\n     * @returns {Promise<KeyPair>}\n     */\n    async getKey(networkId, accountId) {\n        const value = this.localStorage.getItem(this.storageKeyForSecretKey(networkId, accountId));\n        if (!value) {\n            return null;\n        }\n        return key_pair_1.KeyPair.fromString(value);\n    }\n    /**\n     * Removes a {@link KeyPair} from local storage\n     * @param networkId The targeted network. (ex. default, betanet, etc…)\n     * @param accountId The NEAR account tied to the key pair\n     */\n    async removeKey(networkId, accountId) {\n        this.localStorage.removeItem(this.storageKeyForSecretKey(networkId, accountId));\n    }\n    /**\n     * Removes all items that start with `prefix` from local storage\n     */\n    async clear() {\n        for (const key of this.storageKeys()) {\n            if (key.startsWith(this.prefix)) {\n                this.localStorage.removeItem(key);\n            }\n        }\n    }\n    /**\n     * Get the network(s) from local storage\n     * @returns {Promise<string[]>}\n     */\n    async getNetworks() {\n        const result = new Set();\n        for (const key of this.storageKeys()) {\n            if (key.startsWith(this.prefix)) {\n                const parts = key.substring(this.prefix.length).split(':');\n                result.add(parts[1]);\n            }\n        }\n        return Array.from(result.values());\n    }\n    /**\n     * Gets the account(s) from local storage\n     * @param networkId The targeted network. (ex. default, betanet, etc…)\n     * @returns{Promise<string[]>}\n     */\n    async getAccounts(networkId) {\n        const result = new Array();\n        for (const key of this.storageKeys()) {\n            if (key.startsWith(this.prefix)) {\n                const parts = key.substring(this.prefix.length).split(':');\n                if (parts[1] === networkId) {\n                    result.push(parts[0]);\n                }\n            }\n        }\n        return result;\n    }\n    /**\n     * @hidden\n     * Helper function to retrieve a local storage key\n     * @param networkId The targeted network. (ex. default, betanet, etc…)\n     * @param accountId The NEAR account tied to the storage keythat's sought\n     * @returns {string} An example might be: `near-api-js:keystore:near-friend:default`\n     */\n    storageKeyForSecretKey(networkId, accountId) {\n        return `${this.prefix}${accountId}:${networkId}`;\n    }\n    /** @hidden */\n    *storageKeys() {\n        for (let i = 0; i < this.localStorage.length; i++) {\n            yield this.localStorage.key(i);\n        }\n    }\n}\nexports.BrowserLocalStorageKeyStore = BrowserLocalStorageKeyStore;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}