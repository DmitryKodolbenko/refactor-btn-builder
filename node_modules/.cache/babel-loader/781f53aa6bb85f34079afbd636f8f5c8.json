{"ast":null,"code":"\"use strict\";\n\nvar _regeneratorRuntime = require(\"/Users/sepezho/Work/tonana/fe/node_modules/@babel/runtime/helpers/regeneratorRuntime.js\").default;\nvar _createClass = require(\"/Users/sepezho/Work/tonana/fe/node_modules/@babel/runtime/helpers/createClass.js\").default;\nvar _classCallCheck = require(\"/Users/sepezho/Work/tonana/fe/node_modules/@babel/runtime/helpers/classCallCheck.js\").default;\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nvar _a;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.AppNear = void 0;\nvar types_1 = require(\"../../../../../common/types\");\nvar bs58_1 = __importDefault(require(\"bs58\"));\nvar isomorphic_ws_1 = __importDefault(require(\"isomorphic-ws\"));\nvar near_api_js_1 = require(\"near-api-js\");\nvar utils_1 = require(\"near-api-js/lib/utils\");\nvar AppMessages_1 = require(\"../types/AppMessages\");\nvar ServerMessage_1 = require(\"../types/ServerMessage\");\nvar utils_2 = require(\"../utils\");\nvar isomorphic_localstorage_1 = __importDefault(require(\"isomorphic-localstorage\"));\nvar localStorage = (0, isomorphic_localstorage_1.default)('./.localstorage');\nvar sessionIdKey = 'nightly-id-near';\nvar AppNear = /*#__PURE__*/_createClass(function AppNear(ws, timeout) {\n  var _this = this;\n  _classCallCheck(this, AppNear);\n  this.events = {};\n  this.sessionId = '';\n  this.send = function (message) {\n    return __awaiter(_this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n      var _this2 = this;\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              return _context.abrupt(\"return\", new Promise(function (resolve, reject) {\n                var id = (0, utils_2.getRandomId)();\n                var request = JSON.stringify(Object.assign(Object.assign({}, message), {\n                  id: id\n                }));\n                // Set up the timeout\n                var timer = setTimeout(function () {\n                  reject(new Error(\"Connection timed out after \".concat(_this2.timeout, \" ms\")));\n                }, _this2.timeout);\n                _this2.events[id] = function (response) {\n                  clearTimeout(timer);\n                  if (response.type === ServerMessage_1.ServerMessageTypes.Error) {\n                    reject(response.msg);\n                  } else {\n                    resolve(response);\n                  }\n                };\n                _this2.ws.send(request);\n              }));\n            case 1:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n  };\n  this.signTransaction = function (transaction) {\n    return __awaiter(_this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n      var request, response;\n      return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              request = {\n                transaction: Buffer.from(transaction.encode()).toString('hex'),\n                network: types_1.NETWORK.NEAR,\n                type: AppMessages_1.AppMessageTypes.SignTransaction\n              };\n              _context2.next = 3;\n              return this.send(request);\n            case 3:\n              response = _context2.sent;\n              return _context2.abrupt(\"return\", near_api_js_1.transactions.SignedTransaction.decode(Buffer.from(response.transaction, 'hex')));\n            case 5:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, this);\n    }));\n  };\n  this.signAllTransactions = function (txs) {\n    return __awaiter(_this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n      var request, response, parsed;\n      return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              request = {\n                transactions: txs.map(function (tx) {\n                  return Buffer.from(tx.encode()).toString('hex');\n                }),\n                network: types_1.NETWORK.NEAR,\n                type: AppMessages_1.AppMessageTypes.SignAllTransactions\n              };\n              _context3.next = 3;\n              return this.send(request);\n            case 3:\n              response = _context3.sent;\n              parsed = response.transactions.map(function (tx) {\n                return near_api_js_1.transactions.SignedTransaction.decode(Buffer.from(tx, 'hex'));\n              });\n              return _context3.abrupt(\"return\", parsed);\n            case 6:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3, this);\n    }));\n  };\n  this.signMessage = function (message) {\n    return __awaiter(_this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime().mark(function _callee4() {\n      var request, response;\n      return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              request = {\n                message: message,\n                network: types_1.NETWORK.NEAR,\n                type: AppMessages_1.AppMessageTypes.SignMessage\n              };\n              _context4.next = 3;\n              return this.send(request);\n            case 3:\n              response = _context4.sent;\n              return _context4.abrupt(\"return\", Uint8Array.from(Buffer.from(response.signature, 'hex')));\n            case 5:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4, this);\n    }));\n  };\n  this.ws = ws;\n  this.timeout = timeout;\n});\nexports.AppNear = AppNear;\n_a = AppNear;\nAppNear.build = function (_ref) {\n  var appMetadata = _ref.appMetadata,\n    url = _ref.url,\n    onUserConnect = _ref.onUserConnect,\n    _ref$timeout = _ref.timeout,\n    timeout = _ref$timeout === void 0 ? 40 * 1000 : _ref$timeout;\n  return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime().mark(function _callee5() {\n    return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n      while (1) {\n        switch (_context5.prev = _context5.next) {\n          case 0:\n            return _context5.abrupt(\"return\", new Promise(function (resolve, reject) {\n              var persistent = typeof appMetadata.persistent === 'undefined' ? true : appMetadata.persistent;\n              var ws = url ? new isomorphic_ws_1.default(url) : new isomorphic_ws_1.default('wss://relay.nightly.app/app');\n              var connection = new AppNear(ws, timeout);\n              connection.events[ServerMessage_1.ServerMessageTypes.UserConnected] = function (data) {\n                var parsedMeta = JSON.parse(data.metadata);\n                var pk = utils_1.PublicKey.fromString(bs58_1.default.encode(Buffer.from(data.publicKey, 'hex')));\n                onUserConnect({\n                  accountId: parsedMeta.accountId,\n                  publicKey: pk\n                });\n              };\n              connection.ws.onopen = function () {\n                var _b;\n                connection.ws.onmessage = function (_ref2) {\n                  var data = _ref2.data;\n                  var response = JSON.parse(data);\n                  connection.events[response.id](response);\n                };\n                var persistentSessionId = persistent ? (_b = localStorage.getItem(sessionIdKey)) !== null && _b !== void 0 ? _b : undefined : undefined;\n                var request = (0, AppMessages_1.createInitAction)(Object.assign(Object.assign({}, appMetadata), {\n                  network: types_1.NETWORK.NEAR,\n                  persistentSessionId: persistentSessionId\n                }));\n                // Set up the timeout\n                var timer = setTimeout(function () {\n                  reject(new Error(\"Connection timed out after \".concat(connection.timeout, \" ms\")));\n                }, timeout);\n                connection.events[request.id] = function (response) {\n                  clearTimeout(timer);\n                  if (response.type === ServerMessage_1.ServerMessageTypes.InitSuccess) {\n                    connection.sessionId = response.sessionId;\n                    if (persistent) localStorage.setItem(sessionIdKey, response.sessionId);\n                    resolve(connection);\n                  } else {\n                    reject();\n                  }\n                };\n                connection.ws.send(JSON.stringify(request));\n              };\n            }));\n          case 1:\n          case \"end\":\n            return _context5.stop();\n        }\n      }\n    }, _callee5);\n  }));\n};","map":{"version":3,"names":["__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","__importDefault","mod","__esModule","_a","Object","defineProperty","exports","AppNear","types_1","require","bs58_1","isomorphic_ws_1","near_api_js_1","utils_1","AppMessages_1","ServerMessage_1","utils_2","isomorphic_localstorage_1","localStorage","default","sessionIdKey","ws","timeout","events","sessionId","send","message","id","getRandomId","request","JSON","stringify","assign","timer","setTimeout","Error","response","clearTimeout","type","ServerMessageTypes","msg","signTransaction","transaction","Buffer","from","encode","toString","network","NETWORK","NEAR","AppMessageTypes","SignTransaction","transactions","SignedTransaction","decode","signAllTransactions","txs","map","tx","SignAllTransactions","parsed","signMessage","SignMessage","Uint8Array","signature","build","appMetadata","url","onUserConnect","persistent","connection","UserConnected","data","parsedMeta","parse","metadata","pk","PublicKey","fromString","publicKey","accountId","onopen","_b","onmessage","persistentSessionId","getItem","undefined","createInitAction","InitSuccess","setItem"],"sources":["/Users/sepezho/Work/tonana/fe/node_modules/@nightlylabs/connect-near/lib/nightlyConnect/connect/sdk/src/near/appNear.js"],"sourcesContent":["\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nvar _a;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.AppNear = void 0;\nconst types_1 = require(\"../../../../../common/types\");\nconst bs58_1 = __importDefault(require(\"bs58\"));\nconst isomorphic_ws_1 = __importDefault(require(\"isomorphic-ws\"));\nconst near_api_js_1 = require(\"near-api-js\");\nconst utils_1 = require(\"near-api-js/lib/utils\");\nconst AppMessages_1 = require(\"../types/AppMessages\");\nconst ServerMessage_1 = require(\"../types/ServerMessage\");\nconst utils_2 = require(\"../utils\");\nconst isomorphic_localstorage_1 = __importDefault(require(\"isomorphic-localstorage\"));\nconst localStorage = (0, isomorphic_localstorage_1.default)('./.localstorage');\nconst sessionIdKey = 'nightly-id-near';\nclass AppNear {\n    constructor(ws, timeout) {\n        this.events = {};\n        this.sessionId = '';\n        this.send = (message) => __awaiter(this, void 0, void 0, function* () {\n            return new Promise((resolve, reject) => {\n                const id = (0, utils_2.getRandomId)();\n                const request = JSON.stringify(Object.assign(Object.assign({}, message), { id: id }));\n                // Set up the timeout\n                const timer = setTimeout(() => {\n                    reject(new Error(`Connection timed out after ${this.timeout} ms`));\n                }, this.timeout);\n                this.events[id] = (response) => {\n                    clearTimeout(timer);\n                    if (response.type === ServerMessage_1.ServerMessageTypes.Error) {\n                        reject(response.msg);\n                    }\n                    else {\n                        resolve(response);\n                    }\n                };\n                this.ws.send(request);\n            });\n        });\n        this.signTransaction = (transaction) => __awaiter(this, void 0, void 0, function* () {\n            const request = {\n                transaction: Buffer.from(transaction.encode()).toString('hex'),\n                network: types_1.NETWORK.NEAR,\n                type: AppMessages_1.AppMessageTypes.SignTransaction\n            };\n            const response = (yield this.send(request));\n            return near_api_js_1.transactions.SignedTransaction.decode(Buffer.from(response.transaction, 'hex'));\n        });\n        this.signAllTransactions = (txs) => __awaiter(this, void 0, void 0, function* () {\n            const request = {\n                transactions: txs.map((tx) => Buffer.from(tx.encode()).toString('hex')),\n                network: types_1.NETWORK.NEAR,\n                type: AppMessages_1.AppMessageTypes.SignAllTransactions\n            };\n            const response = (yield this.send(request));\n            const parsed = response.transactions.map((tx) => near_api_js_1.transactions.SignedTransaction.decode(Buffer.from(tx, 'hex')));\n            return parsed;\n        });\n        this.signMessage = (message) => __awaiter(this, void 0, void 0, function* () {\n            const request = {\n                message,\n                network: types_1.NETWORK.NEAR,\n                type: AppMessages_1.AppMessageTypes.SignMessage\n            };\n            const response = (yield this.send(request));\n            return Uint8Array.from(Buffer.from(response.signature, 'hex'));\n        });\n        this.ws = ws;\n        this.timeout = timeout;\n    }\n}\nexports.AppNear = AppNear;\n_a = AppNear;\nAppNear.build = ({ appMetadata, url, onUserConnect, timeout = 40 * 1000 // 40s default timeout\n }) => __awaiter(void 0, void 0, void 0, function* () {\n    return new Promise((resolve, reject) => {\n        const persistent = typeof appMetadata.persistent === 'undefined' ? true : appMetadata.persistent;\n        const ws = url ? new isomorphic_ws_1.default(url) : new isomorphic_ws_1.default('wss://relay.nightly.app/app');\n        const connection = new AppNear(ws, timeout);\n        connection.events[ServerMessage_1.ServerMessageTypes.UserConnected] = (data) => {\n            const parsedMeta = JSON.parse(data.metadata);\n            const pk = utils_1.PublicKey.fromString(bs58_1.default.encode(Buffer.from(data.publicKey, 'hex')));\n            onUserConnect({ accountId: parsedMeta.accountId, publicKey: pk });\n        };\n        connection.ws.onopen = () => {\n            var _b;\n            connection.ws.onmessage = ({ data }) => {\n                const response = JSON.parse(data);\n                connection.events[response.id](response);\n            };\n            const persistentSessionId = persistent\n                ? (_b = localStorage.getItem(sessionIdKey)) !== null && _b !== void 0 ? _b : undefined\n                : undefined;\n            const request = (0, AppMessages_1.createInitAction)(Object.assign(Object.assign({}, appMetadata), { network: types_1.NETWORK.NEAR, persistentSessionId }));\n            // Set up the timeout\n            const timer = setTimeout(() => {\n                reject(new Error(`Connection timed out after ${connection.timeout} ms`));\n            }, timeout);\n            connection.events[request.id] = (response) => {\n                clearTimeout(timer);\n                if (response.type === ServerMessage_1.ServerMessageTypes.InitSuccess) {\n                    connection.sessionId = response.sessionId;\n                    if (persistent)\n                        localStorage.setItem(sessionIdKey, response.sessionId);\n                    resolve(connection);\n                }\n                else {\n                    reject();\n                }\n            };\n            connection.ws.send(JSON.stringify(request));\n        };\n    });\n});\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}