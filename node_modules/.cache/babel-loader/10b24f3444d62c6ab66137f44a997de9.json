{"ast":null,"code":"const {\n  Cell\n} = require(\"../../boc\");\nconst {\n  WalletContract\n} = require(\"./WalletContract\");\nclass WalletV3ContractBase extends WalletContract {\n  /**\n   * @override\n   * @private\n   * @param   seqno?   {number}\n   * @return {Cell}\n   */\n  createSigningMessage(seqno) {\n    seqno = seqno || 0;\n    const message = new Cell();\n    message.bits.writeUint(this.options.walletId, 32);\n    if (seqno === 0) {\n      // message.bits.writeInt(-1, 32);// todo: dont work\n      for (let i = 0; i < 32; i++) {\n        message.bits.writeBit(1);\n      }\n    } else {\n      const date = new Date();\n      const timestamp = Math.floor(date.getTime() / 1e3);\n      message.bits.writeUint(timestamp + 60, 32);\n    }\n    message.bits.writeUint(seqno, 32);\n    return message;\n  }\n\n  /**\n   * @override\n   * @return {Cell} cell contains wallet data\n   */\n  createDataCell() {\n    const cell = new Cell();\n    cell.bits.writeUint(0, 32);\n    cell.bits.writeUint(this.options.walletId, 32);\n    cell.bits.writeBytes(this.options.publicKey);\n    return cell;\n  }\n}\nclass WalletV3ContractR1 extends WalletV3ContractBase {\n  /**\n   * @param provider    {HttpProvider}\n   * @param options {any}\n   */\n  constructor(provider, options) {\n    options.code = Cell.oneFromBoc(\"B5EE9C724101010100620000C0FF0020DD2082014C97BA9730ED44D0D70B1FE0A4F2608308D71820D31FD31FD31FF82313BBF263ED44D0D31FD31FD3FFD15132BAF2A15144BAF2A204F901541055F910F2A3F8009320D74A96D307D402FB00E8D101A4C8CB1FCB1FCBFFC9ED543FBE6EE0\");\n    super(provider, options);\n    if (!this.options.walletId) this.options.walletId = 698983191 + this.options.wc;\n  }\n  getName() {\n    return 'v3R1';\n  }\n}\nclass WalletV3ContractR2 extends WalletV3ContractBase {\n  /**\n   * @param provider    {HttpProvider}\n   * @param options {any}\n   */\n  constructor(provider, options) {\n    options.code = Cell.oneFromBoc(\"B5EE9C724101010100710000DEFF0020DD2082014C97BA218201339CBAB19F71B0ED44D0D31FD31F31D70BFFE304E0A4F2608308D71820D31FD31FD31FF82313BBF263ED44D0D31FD31FD3FFD15132BAF2A15144BAF2A204F901541055F910F2A3F8009320D74A96D307D402FB00E8D101A4C8CB1FCB1FCBFFC9ED5410BD6DAD\");\n    super(provider, options);\n    if (!this.options.walletId) this.options.walletId = 698983191 + this.options.wc;\n  }\n  getName() {\n    return 'v3R2';\n  }\n}\nmodule.exports = {\n  WalletV3ContractR1,\n  WalletV3ContractR2\n};","map":{"version":3,"names":["Cell","require","WalletContract","WalletV3ContractBase","createSigningMessage","seqno","message","bits","writeUint","options","walletId","i","writeBit","date","Date","timestamp","Math","floor","getTime","createDataCell","cell","writeBytes","publicKey","WalletV3ContractR1","constructor","provider","code","oneFromBoc","wc","getName","WalletV3ContractR2","module","exports"],"sources":["/Users/sepezho/Work/tonana/fe/node_modules/tonweb/src/contract/wallet/WalletContractV3.js"],"sourcesContent":["const {Cell} = require(\"../../boc\");\nconst {WalletContract} = require(\"./WalletContract\");\n\nclass WalletV3ContractBase extends WalletContract {\n\n    /**\n     * @override\n     * @private\n     * @param   seqno?   {number}\n     * @return {Cell}\n     */\n    createSigningMessage(seqno) {\n        seqno = seqno || 0;\n        const message = new Cell();\n        message.bits.writeUint(this.options.walletId, 32);\n        if (seqno === 0) {\n            // message.bits.writeInt(-1, 32);// todo: dont work\n            for (let i = 0; i < 32; i++) {\n                message.bits.writeBit(1);\n            }\n        } else {\n            const date = new Date();\n            const timestamp = Math.floor(date.getTime() / 1e3);\n            message.bits.writeUint(timestamp + 60, 32);\n        }\n        message.bits.writeUint(seqno, 32);\n        return message;\n    }\n\n    /**\n     * @override\n     * @return {Cell} cell contains wallet data\n     */\n    createDataCell() {\n        const cell = new Cell();\n        cell.bits.writeUint(0, 32);\n        cell.bits.writeUint(this.options.walletId, 32);\n        cell.bits.writeBytes(this.options.publicKey);\n        return cell;\n    }\n}\n\nclass WalletV3ContractR1 extends WalletV3ContractBase {\n    /**\n     * @param provider    {HttpProvider}\n     * @param options {any}\n     */\n    constructor(provider, options) {\n        options.code = Cell.oneFromBoc(\"B5EE9C724101010100620000C0FF0020DD2082014C97BA9730ED44D0D70B1FE0A4F2608308D71820D31FD31FD31FF82313BBF263ED44D0D31FD31FD3FFD15132BAF2A15144BAF2A204F901541055F910F2A3F8009320D74A96D307D402FB00E8D101A4C8CB1FCB1FCBFFC9ED543FBE6EE0\");\n        super(provider, options);\n        if (!this.options.walletId) this.options.walletId = 698983191 + this.options.wc;\n    }\n\n    getName() {\n        return 'v3R1';\n    }\n}\n\nclass WalletV3ContractR2 extends WalletV3ContractBase {\n    /**\n     * @param provider    {HttpProvider}\n     * @param options {any}\n     */\n    constructor(provider, options) {\n        options.code = Cell.oneFromBoc(\"B5EE9C724101010100710000DEFF0020DD2082014C97BA218201339CBAB19F71B0ED44D0D31FD31F31D70BFFE304E0A4F2608308D71820D31FD31FD31FF82313BBF263ED44D0D31FD31FD3FFD15132BAF2A15144BAF2A204F901541055F910F2A3F8009320D74A96D307D402FB00E8D101A4C8CB1FCB1FCBFFC9ED5410BD6DAD\");\n        super(provider, options);\n        if (!this.options.walletId) this.options.walletId = 698983191 + this.options.wc;\n    }\n\n    getName() {\n        return 'v3R2';\n    }\n}\n\nmodule.exports = {WalletV3ContractR1, WalletV3ContractR2};\n\n"],"mappings":"AAAA,MAAM;EAACA;AAAI,CAAC,GAAGC,OAAO,CAAC,WAAW,CAAC;AACnC,MAAM;EAACC;AAAc,CAAC,GAAGD,OAAO,CAAC,kBAAkB,CAAC;AAEpD,MAAME,oBAAoB,SAASD,cAAc,CAAC;EAE9C;AACJ;AACA;AACA;AACA;AACA;EACIE,oBAAoB,CAACC,KAAK,EAAE;IACxBA,KAAK,GAAGA,KAAK,IAAI,CAAC;IAClB,MAAMC,OAAO,GAAG,IAAIN,IAAI,EAAE;IAC1BM,OAAO,CAACC,IAAI,CAACC,SAAS,CAAC,IAAI,CAACC,OAAO,CAACC,QAAQ,EAAE,EAAE,CAAC;IACjD,IAAIL,KAAK,KAAK,CAAC,EAAE;MACb;MACA,KAAK,IAAIM,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,EAAE,EAAEA,CAAC,EAAE,EAAE;QACzBL,OAAO,CAACC,IAAI,CAACK,QAAQ,CAAC,CAAC,CAAC;MAC5B;IACJ,CAAC,MAAM;MACH,MAAMC,IAAI,GAAG,IAAIC,IAAI,EAAE;MACvB,MAAMC,SAAS,GAAGC,IAAI,CAACC,KAAK,CAACJ,IAAI,CAACK,OAAO,EAAE,GAAG,GAAG,CAAC;MAClDZ,OAAO,CAACC,IAAI,CAACC,SAAS,CAACO,SAAS,GAAG,EAAE,EAAE,EAAE,CAAC;IAC9C;IACAT,OAAO,CAACC,IAAI,CAACC,SAAS,CAACH,KAAK,EAAE,EAAE,CAAC;IACjC,OAAOC,OAAO;EAClB;;EAEA;AACJ;AACA;AACA;EACIa,cAAc,GAAG;IACb,MAAMC,IAAI,GAAG,IAAIpB,IAAI,EAAE;IACvBoB,IAAI,CAACb,IAAI,CAACC,SAAS,CAAC,CAAC,EAAE,EAAE,CAAC;IAC1BY,IAAI,CAACb,IAAI,CAACC,SAAS,CAAC,IAAI,CAACC,OAAO,CAACC,QAAQ,EAAE,EAAE,CAAC;IAC9CU,IAAI,CAACb,IAAI,CAACc,UAAU,CAAC,IAAI,CAACZ,OAAO,CAACa,SAAS,CAAC;IAC5C,OAAOF,IAAI;EACf;AACJ;AAEA,MAAMG,kBAAkB,SAASpB,oBAAoB,CAAC;EAClD;AACJ;AACA;AACA;EACIqB,WAAW,CAACC,QAAQ,EAAEhB,OAAO,EAAE;IAC3BA,OAAO,CAACiB,IAAI,GAAG1B,IAAI,CAAC2B,UAAU,CAAC,oOAAoO,CAAC;IACpQ,KAAK,CAACF,QAAQ,EAAEhB,OAAO,CAAC;IACxB,IAAI,CAAC,IAAI,CAACA,OAAO,CAACC,QAAQ,EAAE,IAAI,CAACD,OAAO,CAACC,QAAQ,GAAG,SAAS,GAAG,IAAI,CAACD,OAAO,CAACmB,EAAE;EACnF;EAEAC,OAAO,GAAG;IACN,OAAO,MAAM;EACjB;AACJ;AAEA,MAAMC,kBAAkB,SAAS3B,oBAAoB,CAAC;EAClD;AACJ;AACA;AACA;EACIqB,WAAW,CAACC,QAAQ,EAAEhB,OAAO,EAAE;IAC3BA,OAAO,CAACiB,IAAI,GAAG1B,IAAI,CAAC2B,UAAU,CAAC,kQAAkQ,CAAC;IAClS,KAAK,CAACF,QAAQ,EAAEhB,OAAO,CAAC;IACxB,IAAI,CAAC,IAAI,CAACA,OAAO,CAACC,QAAQ,EAAE,IAAI,CAACD,OAAO,CAACC,QAAQ,GAAG,SAAS,GAAG,IAAI,CAACD,OAAO,CAACmB,EAAE;EACnF;EAEAC,OAAO,GAAG;IACN,OAAO,MAAM;EACjB;AACJ;AAEAE,MAAM,CAACC,OAAO,GAAG;EAACT,kBAAkB;EAAEO;AAAkB,CAAC"},"metadata":{},"sourceType":"script"}