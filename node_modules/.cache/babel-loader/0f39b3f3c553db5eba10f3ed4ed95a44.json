{"ast":null,"code":"\"use strict\";\n\nvar _regeneratorRuntime = require(\"/Users/sepezho/Work/tonana/fe/node_modules/@babel/runtime/helpers/regeneratorRuntime.js\").default;\nvar _asyncToGenerator = require(\"/Users/sepezho/Work/tonana/fe/node_modules/@babel/runtime/helpers/asyncToGenerator.js\").default;\nvar _classCallCheck = require(\"/Users/sepezho/Work/tonana/fe/node_modules/@babel/runtime/helpers/classCallCheck.js\").default;\nvar _createClass = require(\"/Users/sepezho/Work/tonana/fe/node_modules/@babel/runtime/helpers/createClass.js\").default;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ConfigContract = void 0;\nvar __1 = require(\"..\");\nvar BitStringReader_1 = require(\"../boc/BitStringReader\");\nvar Builder_1 = require(\"../boc/Builder\");\nvar parseDict_1 = require(\"../boc/dict/parseDict\");\nvar configParsing_1 = require(\"./configs/configParsing\");\nvar ConfigContract = /*#__PURE__*/function () {\n  function ConfigContract(client) {\n    _classCallCheck(this, ConfigContract);\n    this.address = __1.Address.parseRaw('-1:5555555555555555555555555555555555555555555555555555555555555555');\n    this.source = new __1.UnknownContractSource('org.ton.config', -1, 'Config Contract');\n    this.client = client;\n  }\n  _createClass(ConfigContract, [{\n    key: \"getSeqNo\",\n    value: function () {\n      var _getSeqNo = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var res;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return this.client.callGetMethod(this.address, 'seqno');\n              case 2:\n                res = _context.sent;\n                return _context.abrupt(\"return\", parseInt(res.stack[0][1], 16));\n              case 4:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n      function getSeqNo() {\n        return _getSeqNo.apply(this, arguments);\n      }\n      return getSeqNo;\n    }()\n  }, {\n    key: \"getPublicKey\",\n    value: function () {\n      var _getPublicKey = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n        var data, cell, reader;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return this.client.getContractState(this.address);\n              case 2:\n                data = _context2.sent.data;\n                cell = __1.Cell.fromBoc(data)[0];\n                reader = new BitStringReader_1.BitStringReader(cell.bits);\n                reader.readUint(32); // Seqno\n                return _context2.abrupt(\"return\", reader.readUint(256));\n              case 7:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n      function getPublicKey() {\n        return _getPublicKey.apply(this, arguments);\n      }\n      return getPublicKey;\n    }()\n  }, {\n    key: \"getConfigsRaw\",\n    value: function () {\n      var _getConfigsRaw = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n        var data, slice, dict, res;\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.next = 2;\n                return this.client.getContractState(this.address);\n              case 2:\n                data = _context3.sent.data;\n                slice = __1.Cell.fromBoc(data)[0].beginParse();\n                dict = slice.readRef();\n                res = (0, parseDict_1.parseDictRefs)(dict, 32);\n                return _context3.abrupt(\"return\", res);\n              case 7:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n      function getConfigsRaw() {\n        return _getConfigsRaw.apply(this, arguments);\n      }\n      return getConfigsRaw;\n    }()\n  }, {\n    key: \"getConfigs\",\n    value: function () {\n      var _getConfigs = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4() {\n        var configs;\n        return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _context4.next = 2;\n                return this.getConfigsRaw();\n              case 2:\n                configs = _context4.sent;\n                return _context4.abrupt(\"return\", (0, configParsing_1.parseFullConfig)(configs));\n              case 4:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n      function getConfigs() {\n        return _getConfigs.apply(this, arguments);\n      }\n      return getConfigs;\n    }()\n  }, {\n    key: \"createProposal\",\n    value: function () {\n      var _createProposal = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5(args) {\n        return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                return _context5.abrupt(\"return\", (0, Builder_1.beginCell)().storeUint(0x6e565052, 32).storeUint(args.queryId, 64).storeUint(args.expiresAt, 32).storeRef((0, Builder_1.beginCell)().storeUint(0xf3, 8).storeUint(args.paramId, 32).storeRefMaybe(args.paramValue).storeRefMaybe(args.ifHashEqual).endCell()).storeBit(args.critical).endCell());\n              case 1:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5);\n      }));\n      function createProposal(_x) {\n        return _createProposal.apply(this, arguments);\n      }\n      return createProposal;\n    }()\n  }]);\n  return ConfigContract;\n}();\nexports.ConfigContract = ConfigContract;","map":{"version":3,"names":["Object","defineProperty","exports","value","ConfigContract","__1","require","BitStringReader_1","Builder_1","parseDict_1","configParsing_1","client","address","Address","parseRaw","source","UnknownContractSource","callGetMethod","res","parseInt","stack","getContractState","data","cell","Cell","fromBoc","reader","BitStringReader","bits","readUint","slice","beginParse","dict","readRef","parseDictRefs","getConfigsRaw","configs","parseFullConfig","args","beginCell","storeUint","queryId","expiresAt","storeRef","paramId","storeRefMaybe","paramValue","ifHashEqual","endCell","storeBit","critical"],"sources":["/Users/sepezho/Work/tonana/fe/node_modules/ton/dist/contracts/ConfigContract.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ConfigContract = void 0;\nconst __1 = require(\"..\");\nconst BitStringReader_1 = require(\"../boc/BitStringReader\");\nconst Builder_1 = require(\"../boc/Builder\");\nconst parseDict_1 = require(\"../boc/dict/parseDict\");\nconst configParsing_1 = require(\"./configs/configParsing\");\nclass ConfigContract {\n    constructor(client) {\n        this.address = __1.Address.parseRaw('-1:5555555555555555555555555555555555555555555555555555555555555555');\n        this.source = new __1.UnknownContractSource('org.ton.config', -1, 'Config Contract');\n        this.client = client;\n    }\n    async getSeqNo() {\n        let res = await this.client.callGetMethod(this.address, 'seqno');\n        return parseInt(res.stack[0][1], 16);\n    }\n    async getPublicKey() {\n        let data = (await this.client.getContractState(this.address)).data;\n        let cell = __1.Cell.fromBoc(data)[0];\n        let reader = new BitStringReader_1.BitStringReader(cell.bits);\n        reader.readUint(32); // Seqno\n        return reader.readUint(256); // Public Key\n    }\n    async getConfigsRaw() {\n        let data = (await this.client.getContractState(this.address)).data;\n        let slice = __1.Cell.fromBoc(data)[0].beginParse();\n        let dict = slice.readRef();\n        let res = (0, parseDict_1.parseDictRefs)(dict, 32);\n        return res;\n    }\n    async getConfigs() {\n        let configs = await this.getConfigsRaw();\n        return (0, configParsing_1.parseFullConfig)(configs);\n    }\n    async createProposal(args) {\n        return (0, Builder_1.beginCell)()\n            .storeUint(0x6e565052, 32)\n            .storeUint(args.queryId, 64)\n            .storeUint(args.expiresAt, 32)\n            .storeRef((0, Builder_1.beginCell)()\n            .storeUint(0xf3, 8)\n            .storeUint(args.paramId, 32)\n            .storeRefMaybe(args.paramValue)\n            .storeRefMaybe(args.ifHashEqual)\n            .endCell())\n            .storeBit(args.critical)\n            .endCell();\n    }\n}\nexports.ConfigContract = ConfigContract;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}