{"ast":null,"code":"var _jsxFileName = \"/Users/sepezho/Work/tonana/fe/src/contexts/WalletSelectorContext.tsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { useCallback, useContext, useEffect, useState } from \"react\";\nimport { map, distinctUntilChanged } from \"rxjs\";\nimport { setupWalletSelector } from \"@near-wallet-selector/core\";\nimport { setupModal } from \"@near-wallet-selector/modal-ui\";\nimport { setupDefaultWallets } from \"@near-wallet-selector/default-wallets\";\nimport { setupNearWallet } from \"@near-wallet-selector/near-wallet\";\nimport { setupHereWallet } from \"@near-wallet-selector/here-wallet\";\nimport { setupSender } from \"@near-wallet-selector/sender\";\nimport { setupMathWallet } from \"@near-wallet-selector/math-wallet\";\nimport { setupNightly } from \"@near-wallet-selector/nightly\";\nimport { setupMeteorWallet } from \"@near-wallet-selector/meteor-wallet\";\nimport { setupWelldoneWallet } from \"@near-wallet-selector/welldone-wallet\";\nimport { setupNightlyConnect } from \"@near-wallet-selector/nightly-connect\";\nimport { setupNearFi } from \"@near-wallet-selector/nearfi\";\n// import { setupWalletConnect } from \"@near-wallet-selector/wallet-connect\";\nimport { setupCoin98Wallet } from \"@near-wallet-selector/coin98-wallet\";\nimport { setupNeth } from \"@near-wallet-selector/neth\";\nimport { setupOptoWallet } from \"@near-wallet-selector/opto-wallet\";\n// import { CONTRACT_ID } from \"../constants\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CONTRACT_ID = \"tonana.near\";\nconst WalletSelectorContext = /*#__PURE__*/React.createContext(null);\nexport const WalletSelectorContextProvider = _ref => {\n  _s();\n  var _accounts$find;\n  let {\n    children\n  } = _ref;\n  const [selector, setSelector] = useState(null);\n  const [modal, setModal] = useState(null);\n  const [accounts, setAccounts] = useState([]);\n  const init = useCallback(async () => {\n    const _selector = await setupWalletSelector({\n      network: \"testnet\",\n      debug: true,\n      modules: [...(await setupDefaultWallets()), setupNearWallet(), setupSender(), setupMathWallet(), setupNightly(), setupMeteorWallet(), setupWelldoneWallet(), setupHereWallet(), setupCoin98Wallet(), setupNearFi(), setupNeth({\n        gas: \"300000000000000\",\n        bundle: false\n      }), setupOptoWallet(),\n      // setupWalletConnect({\n      // \tprojectId: \"c4f79cc...\",\n      // \tmetadata: {\n      // \t\tname: \"NEAR Wallet Selector\",\n      // \t\tdescription: \"Example dApp used by NEAR Wallet Selector\",\n      // \t\turl: \"https://github.com/near/wallet-selector\",\n      // \t\ticons: [\"https://avatars.githubusercontent.com/u/37784886\"],\n      // \t},\n      // }),\n      setupNightlyConnect({\n        url: \"wss://relay.nightly.app/app\",\n        appMetadata: {\n          additionalInfo: \"\",\n          application: \"NEAR Wallet Selector\",\n          description: \"Example dApp used by NEAR Wallet Selector\",\n          icon: \"https://near.org/wp-content/uploads/2020/09/cropped-favicon-192x192.png\"\n        }\n      })]\n    });\n    const _modal = setupModal(_selector, {\n      contractId: CONTRACT_ID\n    });\n    const state = _selector.store.getState();\n    setAccounts(state.accounts);\n    window.selector = _selector;\n    window.modal = _modal;\n    setSelector(_selector);\n    setModal(_modal);\n  }, []);\n  useEffect(() => {\n    init().catch(err => {\n      console.error(err);\n      alert(\"Failed to initialise wallet selector\");\n    });\n  }, [init]);\n  useEffect(() => {\n    if (!selector) {\n      return;\n    }\n    const subscription = selector.store.observable.pipe(map(state => state.accounts), distinctUntilChanged()).subscribe(nextAccounts => {\n      console.log(\"Accounts Update\", nextAccounts);\n      setAccounts(nextAccounts);\n    });\n    return () => subscription.unsubscribe();\n  }, [selector]);\n  if (!selector || !modal) {\n    return null;\n  }\n  const accountId = ((_accounts$find = accounts.find(account => account.active)) === null || _accounts$find === void 0 ? void 0 : _accounts$find.accountId) || null;\n  return /*#__PURE__*/_jsxDEV(WalletSelectorContext.Provider, {\n    value: {\n      selector,\n      modal,\n      accounts,\n      accountId\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 133,\n    columnNumber: 3\n  }, this);\n};\n_s(WalletSelectorContextProvider, \"n7zUt7aMdQxRRMd+PlibyVcsgzc=\");\n_c = WalletSelectorContextProvider;\nexport function useWalletSelector() {\n  _s2();\n  const context = useContext(WalletSelectorContext);\n  if (!context) {\n    throw new Error(\"useWalletSelector must be used within a WalletSelectorContextProvider\");\n  }\n  return context;\n}\n_s2(useWalletSelector, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\nvar _c;\n$RefreshReg$(_c, \"WalletSelectorContextProvider\");","map":{"version":3,"names":["React","useCallback","useContext","useEffect","useState","map","distinctUntilChanged","setupWalletSelector","setupModal","setupDefaultWallets","setupNearWallet","setupHereWallet","setupSender","setupMathWallet","setupNightly","setupMeteorWallet","setupWelldoneWallet","setupNightlyConnect","setupNearFi","setupCoin98Wallet","setupNeth","setupOptoWallet","CONTRACT_ID","WalletSelectorContext","createContext","WalletSelectorContextProvider","children","selector","setSelector","modal","setModal","accounts","setAccounts","init","_selector","network","debug","modules","gas","bundle","url","appMetadata","additionalInfo","application","description","icon","_modal","contractId","state","store","getState","window","catch","err","console","error","alert","subscription","observable","pipe","subscribe","nextAccounts","log","unsubscribe","accountId","find","account","active","useWalletSelector","context","Error"],"sources":["/Users/sepezho/Work/tonana/fe/src/contexts/WalletSelectorContext.tsx"],"sourcesContent":["import type { ReactNode } from \"react\";\nimport React, { useCallback, useContext, useEffect, useState } from \"react\";\nimport { map, distinctUntilChanged } from \"rxjs\";\nimport { setupWalletSelector } from \"@near-wallet-selector/core\";\nimport type { WalletSelector, AccountState } from \"@near-wallet-selector/core\";\nimport { setupModal } from \"@near-wallet-selector/modal-ui\";\nimport type { WalletSelectorModal } from \"@near-wallet-selector/modal-ui\";\nimport { setupDefaultWallets } from \"@near-wallet-selector/default-wallets\";\nimport { setupNearWallet } from \"@near-wallet-selector/near-wallet\";\nimport { setupHereWallet } from \"@near-wallet-selector/here-wallet\";\nimport { setupSender } from \"@near-wallet-selector/sender\";\nimport { setupMathWallet } from \"@near-wallet-selector/math-wallet\";\nimport { setupNightly } from \"@near-wallet-selector/nightly\";\nimport { setupMeteorWallet } from \"@near-wallet-selector/meteor-wallet\";\nimport { setupWelldoneWallet } from \"@near-wallet-selector/welldone-wallet\";\nimport { setupNightlyConnect } from \"@near-wallet-selector/nightly-connect\";\nimport { setupNearFi } from \"@near-wallet-selector/nearfi\";\n// import { setupWalletConnect } from \"@near-wallet-selector/wallet-connect\";\nimport { setupCoin98Wallet } from \"@near-wallet-selector/coin98-wallet\";\nimport { setupNeth } from \"@near-wallet-selector/neth\";\nimport { setupOptoWallet } from \"@near-wallet-selector/opto-wallet\";\n// import { CONTRACT_ID } from \"../constants\";\nconst CONTRACT_ID = \"tonana.near\";\ndeclare global {\n\tinterface Window {\n\t\tselector: WalletSelector;\n\t\tmodal: WalletSelectorModal;\n\t}\n}\n\ninterface WalletSelectorContextValue {\n\tselector: WalletSelector;\n\tmodal: WalletSelectorModal;\n\taccounts: Array<AccountState>;\n\taccountId: string | null;\n}\n\nconst WalletSelectorContext =\n\tReact.createContext<WalletSelectorContextValue | null>(null);\n\nexport const WalletSelectorContextProvider: React.FC<{\n\tchildren: ReactNode;\n}> = ({ children }) => {\n\tconst [selector, setSelector] = useState<WalletSelector | null>(null);\n\tconst [modal, setModal] = useState<WalletSelectorModal | null>(null);\n\tconst [accounts, setAccounts] = useState<Array<AccountState>>([]);\n\n\tconst init = useCallback(async () => {\n\t\tconst _selector = await setupWalletSelector({\n\t\t\tnetwork: \"testnet\",\n\t\t\tdebug: true,\n\t\t\tmodules: [\n\t\t\t\t...(await setupDefaultWallets()),\n\t\t\t\tsetupNearWallet(),\n\t\t\t\tsetupSender(),\n\t\t\t\tsetupMathWallet(),\n\t\t\t\tsetupNightly(),\n\t\t\t\tsetupMeteorWallet(),\n\t\t\t\tsetupWelldoneWallet(),\n\t\t\t\tsetupHereWallet(),\n\t\t\t\tsetupCoin98Wallet(),\n\t\t\t\tsetupNearFi(),\n\t\t\t\tsetupNeth({\n\t\t\t\t\tgas: \"300000000000000\",\n\t\t\t\t\tbundle: false,\n\t\t\t\t}),\n\t\t\t\tsetupOptoWallet(),\n\t\t\t\t// setupWalletConnect({\n\t\t\t\t// \tprojectId: \"c4f79cc...\",\n\t\t\t\t// \tmetadata: {\n\t\t\t\t// \t\tname: \"NEAR Wallet Selector\",\n\t\t\t\t// \t\tdescription: \"Example dApp used by NEAR Wallet Selector\",\n\t\t\t\t// \t\turl: \"https://github.com/near/wallet-selector\",\n\t\t\t\t// \t\ticons: [\"https://avatars.githubusercontent.com/u/37784886\"],\n\t\t\t\t// \t},\n\t\t\t\t// }),\n\t\t\t\tsetupNightlyConnect({\n\t\t\t\t\turl: \"wss://relay.nightly.app/app\",\n\t\t\t\t\tappMetadata: {\n\t\t\t\t\t\tadditionalInfo: \"\",\n\t\t\t\t\t\tapplication: \"NEAR Wallet Selector\",\n\t\t\t\t\t\tdescription: \"Example dApp used by NEAR Wallet Selector\",\n\t\t\t\t\t\ticon: \"https://near.org/wp-content/uploads/2020/09/cropped-favicon-192x192.png\",\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t],\n\t\t});\n\t\tconst _modal = setupModal(_selector, { contractId: CONTRACT_ID });\n\t\tconst state = _selector.store.getState();\n\t\tsetAccounts(state.accounts);\n\n\t\twindow.selector = _selector;\n\t\twindow.modal = _modal;\n\n\t\tsetSelector(_selector);\n\t\tsetModal(_modal);\n\t}, []);\n\n\tuseEffect(() => {\n\t\tinit().catch((err) => {\n\t\t\tconsole.error(err);\n\t\t\talert(\"Failed to initialise wallet selector\");\n\t\t});\n\t}, [init]);\n\n\tuseEffect(() => {\n\t\tif (!selector) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst subscription = selector.store.observable\n\t\t\t.pipe(\n\t\t\t\tmap((state) => state.accounts),\n\t\t\t\tdistinctUntilChanged()\n\t\t\t)\n\t\t\t.subscribe((nextAccounts) => {\n\t\t\t\tconsole.log(\"Accounts Update\", nextAccounts);\n\n\t\t\t\tsetAccounts(nextAccounts);\n\t\t\t});\n\n\t\treturn () => subscription.unsubscribe();\n\t}, [selector]);\n\n\tif (!selector || !modal) {\n\t\treturn null;\n\t}\n\n\tconst accountId =\n\t\taccounts.find((account) => account.active)?.accountId || null;\n\n\treturn (\n\t\t<WalletSelectorContext.Provider\n\t\t\tvalue={{\n\t\t\t\tselector,\n\t\t\t\tmodal,\n\t\t\t\taccounts,\n\t\t\t\taccountId,\n\t\t\t}}>\n\t\t\t{children}\n\t\t</WalletSelectorContext.Provider>\n\t);\n};\n\nexport function useWalletSelector() {\n\tconst context = useContext(WalletSelectorContext);\n\n\tif (!context) {\n\t\tthrow new Error(\n\t\t\t\"useWalletSelector must be used within a WalletSelectorContextProvider\"\n\t\t);\n\t}\n\n\treturn context;\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}